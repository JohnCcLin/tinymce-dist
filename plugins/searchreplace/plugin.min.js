!function(){function e(e){return e&&1==e.nodeType&&"false"===e.contentEditable}tinymce.PluginManager.add("searchreplace",function(t){var n=this,a=-1;function r(){var e,r={};function i(){o.statusbar.find("#next").disabled(!l(a+1).length),o.statusbar.find("#prev").disabled(!l(a-1).length)}function d(){t.windowManager.alert("Could not find the specified string.",function(){o.find("#find")[0].focus()})}e=tinymce.trim(t.selection.getContent({format:"text"}));var o=t.windowManager.open({layout:"flex",pack:"center",align:"center",onClose:function(){t.focus(),n.done()},onSubmit:function(e){var t,c,s,f;return e.preventDefault(),c=o.find("#case").checked(),f=o.find("#words").checked(),(s=o.find("#find").value()).length?r.text==s&&r.caseState==c&&r.wholeWord==f?0===l(a+1).length?void d():(n.next(),void i()):((t=n.find(s,c,f))||d(),o.statusbar.items().slice(1).disabled(0===t),i(),void(r={text:s,caseState:c,wholeWord:f})):(n.done(!1),void o.statusbar.items().slice(1).disabled(!0))},buttons:[{text:"Find",subtype:"primary",onclick:function(){o.submit()}},{text:"Replace",disabled:!0,onclick:function(){n.replace(o.find("#replace").value(),!1)||(o.statusbar.items().slice(1).disabled(!0),a=-1,r={})}},{text:"Replace all",disabled:!0,onclick:function(){n.replace(o.find("#replace").value(),!0,!0),o.statusbar.items().slice(1).disabled(!0),r={}}},{type:"spacer",flex:1},{text:"Prev",name:"prev",disabled:!0,onclick:function(){n.prev(),i()}},{text:"Next",name:"next",disabled:!0,onclick:function(){n.next(),i()}}],title:"Find and replace",items:{type:"form",padding:20,labelGap:30,spacing:10,items:[{type:"textbox",name:"find",size:40,label:"Find",value:e},{type:"textbox",name:"replace",size:40,label:"Replace with"},{type:"checkbox",name:"case",text:"Match case",label:" "},{type:"checkbox",name:"words",text:"Whole words",label:" "}]}})}function i(e){var t=e.getAttribute("data-mce-index");return"number"==typeof t?""+t:t}function d(a){var r,i;return(i=t.dom.create("span",{"data-mce-bogus":1})).className="mce-match-marker",r=t.getBody(),n.done(!1),function(t,n,a,r,i){var d,o,l,c,s,f,u=[],h=0;function m(e,t){if(t=t||0,!e[0])throw"findAndReplaceDOMText cannot handle zero-length matches";var n=e.index;if(t>0){var a=e[t];if(!a)throw"Invalid capture group";n+=e[0].indexOf(a),e[0]=a}return[n,n+e[0].length,[e[0]]]}if(l=n.ownerDocument,c=i.getBlockElements(),s=i.getWhiteSpaceElements(),f=i.getShortEndedElements(),o=function t(n){var a;if(3===n.nodeType)return n.data;if(s[n.nodeName]&&!c[n.nodeName])return"";if(a="",e(n))return"\n";if((c[n.nodeName]||f[n.nodeName])&&(a+="\n"),n=n.firstChild)do{a+=t(n)}while(n=n.nextSibling);return a}(n)){if(t.global)for(;d=t.exec(o);)u.push(m(d,r));else d=o.match(t),u.push(m(d,r));return u.length&&(h=u.length,function(t,n,a){var r,i,d,o,l=[],u=0,h=t,m=n.shift(),p=0;e:for(;;){if((c[h.nodeName]||f[h.nodeName]||e(h))&&u++,3===h.nodeType&&(!i&&h.length+u>=m[1]?(i=h,o=m[1]-u):r&&l.push(h),!r&&h.length+u>m[0]&&(r=h,d=m[0]-u),u+=h.length),r&&i){if(h=a({startNode:r,startNodeIndex:d,endNode:i,endNodeIndex:o,innerNodes:l,match:m[2],matchIndex:p}),u-=i.length-o,r=null,i=null,l=[],p++,!(m=n.shift()))break}else if(s[h.nodeName]&&!c[h.nodeName]||!h.firstChild){if(h.nextSibling){h=h.nextSibling;continue}}else if(!e(h)){h=h.firstChild;continue}for(;;){if(h.nextSibling){h=h.nextSibling;break}if(h.parentNode===t)break e;h=h.parentNode}}}(n,u,function(e){var t;if("function"!=typeof e){var n=e.nodeType?e:l.createElement(e);t=function(e,t){var a=n.cloneNode(!1);return a.setAttribute("data-mce-index",t),e&&a.appendChild(l.createTextNode(e)),a}}else t=e;return function(e){var n,a,r,i=e.startNode,d=e.endNode,o=e.matchIndex;if(i===d){var c=i;r=c.parentNode,e.startNodeIndex>0&&(n=l.createTextNode(c.data.substring(0,e.startNodeIndex)),r.insertBefore(n,c));var s=t(e.match[0],o);return r.insertBefore(s,c),e.endNodeIndex<c.length&&(a=l.createTextNode(c.data.substring(e.endNodeIndex)),r.insertBefore(a,c)),c.parentNode.removeChild(c),s}n=l.createTextNode(i.data.substring(0,e.startNodeIndex)),a=l.createTextNode(d.data.substring(e.endNodeIndex));for(var f=t(i.data.substring(e.startNodeIndex),o),u=[],h=0,m=e.innerNodes.length;h<m;++h){var p=e.innerNodes[h],g=t(p.data,o);p.parentNode.replaceChild(g,p),u.push(g)}var v=t(d.data.substring(0,e.endNodeIndex),o);return(r=i.parentNode).insertBefore(n,i),r.insertBefore(f,i),r.removeChild(i),(r=d.parentNode).insertBefore(v,d),r.insertBefore(a,d),r.removeChild(d),v}}(a))),h}}(a,r,i,!1,t.schema)}function o(e){var t=e.parentNode;e.firstChild&&t.insertBefore(e.firstChild,e),e.parentNode.removeChild(e)}function l(e){var n,a=[];if((n=tinymce.toArray(t.getBody().getElementsByTagName("span"))).length)for(var r=0;r<n.length;r++){var d=i(n[r]);null!==d&&d.length&&d===e.toString()&&a.push(n[r])}return a}function c(e){var n=a,r=t.dom;(e=!1!==e)?n++:n--,r.removeClass(l(a),"mce-match-marker-selected");var i=l(n);return i.length?(r.addClass(l(n),"mce-match-marker-selected"),t.selection.scrollIntoView(i[0]),n):-1}function s(e){var n=t.dom,a=e.parentNode;n.remove(e),n.isEmpty(a)&&n.remove(a)}function f(e){var t=i(e);return null!==t&&t.length>0}n.init=function(e){e.addMenuItem("searchreplace",{text:"Find and replace",shortcut:"Meta+F",onclick:r,separator:"before",context:"edit"}),e.addButton("searchreplace",{tooltip:"Find and replace",shortcut:"Meta+F",onclick:r}),e.addCommand("SearchReplace",r),e.shortcuts.add("Meta+F","",r)},n.find=function(e,t,n){e=e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),e=n?"\\b"+e+"\\b":e;var r=d(new RegExp(e,t?"g":"gi"));return r&&(a=-1,a=c(!0)),r},n.next=function(){var e=c(!0);-1!==e&&(a=e)},n.prev=function(){var e=c(!1);-1!==e&&(a=e)},n.replace=function(e,r,d){var c,u,h,m,p,g,v=a;for(r=!1!==r,h=t.getBody(),u=tinymce.grep(tinymce.toArray(h.getElementsByTagName("span")),f),c=0;c<u.length;c++){var x=i(u[c]);if(m=p=parseInt(x,10),d||m===a){for(e.length?(u[c].firstChild.nodeValue=e,o(u[c])):s(u[c]);u[++c];){if((m=parseInt(i(u[c]),10))!==p){c--;break}s(u[c])}r&&v--}else p>a&&u[c].setAttribute("data-mce-index",p-1)}return t.undoManager.add(),a=v,r?(g=l(v+1).length>0,n.next()):(g=l(v-1).length>0,n.prev()),!d&&g},n.done=function(e){var n,r,d,l;for(r=tinymce.toArray(t.getBody().getElementsByTagName("span")),n=0;n<r.length;n++){var c=i(r[n]);null!==c&&c.length&&(c===a.toString()&&(d||(d=r[n].firstChild),l=r[n].firstChild),o(r[n]))}if(d&&l){var s=t.dom.createRng();return s.setStart(d,0),s.setEnd(l,l.data.length),!1!==e&&t.selection.setRng(s),s}}})}();